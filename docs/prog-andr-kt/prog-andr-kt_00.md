# 前言

JetBrains 创建 Kotlin 的原因有两个：一是没有语言可以填补使用（传统）Java 库进行 Android 开发中的所有空白，二是新语言可以让 Android 开发引领潮流，而不仅仅是跟随。

Kotlin 1.0 在 2015 年 2 月正式宣布。Kotlin 简洁、安全、务实，并专注于与 Java 代码的互操作性。它可以在目前使用 Java 的任何地方使用：用于服务器端开发、Android 应用程序、桌面或便携客户端、IoT 设备编程等等。Kotlin 在 Android 开发者中迅速流行起来，Google 决定将 Kotlin 作为官方 Android 开发语言，导致了人们对该语言的兴趣急剧增长。根据 [Android Developers 网站](https://developer.android.com/kotlin)，超过 60% 的专业 Android 开发者目前使用 Kotlin。

Android 的学习曲线相当陡峭：诚然，学习难度大，掌握更难。对于许多人来说，成为 Android 开发者的一部分是随着时间暴露于 Android 操作系统与应用程序之间的意外交互。本书旨在通过深入分析 Android 中的这些问题，向读者展示这种类型的暴露情况。我们不仅将讨论 Kotlin 和 Java，还将讨论在使用 Android 时可能出现的并发问题，以及 Kotlin 如何解决这些问题。

我们有时会将 Kotlin 与 Java 进行比较，因为我们认为这样做可以提供更好的见解（特别是因为大多数读者预计具有 Java 背景）。我们可以通过可工作的示例演示如何弥合差距，以及大多数 Kotlin 操作的基本概念与 Java 等效操作更相似的方式。这些任务将按主题组织，以提供软件工程师对该大量信息的结构化分解，并展示如何使应用程序更加强壮和可维护。

此外，熟悉 Java 的用户，包括 Android 开发者，在我们以 Java 和 Kotlin 分别展示每个常见任务时，将发现他们的学习曲线大大平缓。在适当的时候，我们将讨论一个或两者的差异和 pitfalls，但我们希望提供一些易于消化的示例，让任务“一切顺利”，并使读者能够消化和适应现代范式，并立即本能地意识到更新代码的重要性。

虽然 Kotlin 与 Java 完全互操作，但其他 Java 应用程序开发（服务器端编程、桌面客户端、中间件等）尚未像安卓那样普及。这在很大程度上是因为安卓的维护者（谷歌）强烈“鼓励”用户进行转变。用户定期迁移到 Kotlin，但更多的仍然因为任务关键性工作而回到 Java。我们希望这本书能成为安卓开发者在承诺 Kotlin 所代表的优势和简单性时所需的生命线。

# 谁应该读这本书

*超过六百万名安卓工程师*。我们相信几乎每一位安卓工程师都能从这本书中受益。虽然只有少数人精通 Kotlin，但他们可能也会从我们提供的信息中学到一些东西。但实际上，我们的目标是那些尚未过渡到 Kotlin 的绝大多数人。这本书也适合那些尝试过一点 Kotlin，但在 Kotlin 的熟悉程度上还没有达到在以 Java 为中心的安卓开发中所积累的水平：

场景 1

读者精通 Java，听说过这种新的 Kotlin 语言，并想尝试一下。因此，他们阅读了一些在线教程，开始使用它，效果很好。不久他们意识到这不仅仅是一种新的语法。习语不同（例如函数式编程、协程），现在也可能有一整套新的开发方式。但是他们缺乏指导、结构。对他们来说，这本书是一个完美的选择。

场景 2

读者是一个由几位 Java 开发者组成的小团队的一部分。他们讨论是否应该在项目中开始包含 Kotlin。即使 Kotlin 被说成与 Java 百分之百互操作，一些同事认为引入另一种语言会增加项目的复杂性。其他人则认为这可能会限制能够参与项目的同事数量，因为需要掌握两种语言。如果读者能证明收益大于成本，他们可以利用这本书说服他们的同事。

场景 3

一位经验丰富的安卓开发者可能已经试过 Kotlin 或者写过其中的一个功能，但在需要完成任务时仍然依赖于 Java。当我们意识到现在我们正在推广的这本书会让我们的生活变得更加轻松时，我们处于这种情况。这也是我们周围最常见的状态——许多安卓开发者接触过 Kotlin，许多人觉得自己在必要时能写出来，但他们可能不知道，或者简单地不认同，数据类、不可变属性和结构化并发的重要性。我们认为这本书会把一个好奇者变成一名坚定的倡导者。

# 为什么写这本书

有很多书籍展示了 Android 的工作原理，Kotlin 的运行方式，或者并发的工作方式。Kotlin 因其易于采用和更清晰的语法在 Android 开发中变得异常流行，但 Kotlin 为 Android 提供的远不止此：它为解决 Android 中的并发问题提供了新的解决方法。我们编写本书的目的是深入探讨这些主题的独特和特定交集。Android 和 Kotlin 都在快速变化，无论是单独还是共同。试图跟上所有变化可能会很困难。

我们视这本书为历史上的一个有价值的检查点：展示了 Android 的起源，现在的位置以及随着 Kotlin 语言成熟它将如何继续发展。

# 阅读本书

有时我们会将代码片段作为屏幕截图包含，而不是常规的 atlas 代码格式。这在使用协程和流时特别有用，因为悬停点可以清晰地识别。我们还从 IDE 中获取类型提示。

第一章，“Kotlin 基础” 和 第二章，“Kotlin 集合框架” 讨论了在 Kotlin 中实现的 Android 中的主要显著转变。虽然这些章节中的信息足以为您提供对 Kotlin 的良好基础，但更多的章节将深入探讨更复杂/高级的功能。熟悉 Java 或类似语法结构的用户会发现翻译令人惊讶地自然。

第三章，“Android 基础” 和 第四章，“Android 中的并发” 将为您提供关于 Android 系统在内存和线程方面的基础知识。与任何其他操作系统一样，并发是难以实现的。

第五章，“线程安全” 到 第十一章，“使用 Android 性能分析工具考虑性能问题” 探讨围绕内存和线程的常见问题，同时指出 Android 框架随时间如何演变以赋予开发者更多控制权。同时，这些章节展示了 Kotlin 的扩展和语言特性如何帮助开发者更快地编写更好的应用程序。

第十二章，“通过性能优化减少资源消耗” 探索使用强大的 Android 开发者工具来检查性能和与内存相关的分析，以便能够看到你以前从未真正了解过的东西。本书将为工程师提供专业开发和策划的本地 Android 开发中看到的最常见任务的实现。许多任务将包括一个真实世界的问题，接着是 Java 和 Kotlin 的相应解决方案。当需要进一步解释时，解决方案将遵循简洁和自然语言为重点的快速比较和对比模型。

# 本书使用的约定

本书使用以下排版约定：

*斜体*

表示新术语、网址、电子邮件地址、文件名和文件扩展名。

`等宽字体`

用于程序列表，也可在段落内引用程序元素，如变量或函数名称、数据库、数据类型、环境变量、语句和关键字。

**`等宽粗体`**

显示用户应按字面输入的命令或其他文本。

*`等宽斜体`*

显示应由用户提供值或由上下文确定值的文本。

###### 提示

此元素表示提示或建议。

###### 注意

此元素表示一般注释。

###### 警告

此元素表示警告或注意。

# 使用代码示例

补充材料（代码示例、练习等）可在[*https://github.com/ProgrammingAndroidWithKotlin*](https://github.com/ProgrammingAndroidWithKotlin)下载。

如果您有技术问题或使用代码示例时遇到问题，请发送电子邮件至*bookquestions@oreilly.com*。

本书旨在帮助您完成工作。一般而言，如果本书提供示例代码，则您可以在自己的程序和文档中使用它。除非您重现了代码的大部分内容，否则无需联系我们以获得许可。例如，编写使用本书多个代码片段的程序不需要许可。销售或分发 O’Reilly 书籍中的示例代码需要许可。引用本书并引用示例代码回答问题不需要许可。将本书大量示例代码整合到产品文档中需要许可。

我们欢迎，但通常不要求署名。署名通常包括标题、作者、出版商和 ISBN。例如：“*使用 Kotlin 编程 Android*，作者 Pierre-Olivier Laurence、Amanda Hinchman-Dominguez、G. Blake Meike 和 Mike Dunn（O’Reilly）。版权所有 2022 年 Pierre-Olivier Laurence 和 Amanda Hinchman-Dominguez，978-1-492-06300-1。”

如果您认为您对代码示例的使用超出了公平使用范围或上述许可，请随时通过*permissions@oreilly.com*联系我们。

# O’Reilly 在线学习

###### 注意

40 多年来，[*O’Reilly Media*](http://oreilly.com)提供技术和业务培训、知识和见解，帮助公司取得成功。

我们独特的专家和创新者网络通过书籍、文章和我们的在线学习平台分享他们的知识和专业知识。O’Reilly 的在线学习平台为您提供按需访问的实时培训课程、深度学习路径、交互式编码环境以及来自 O’Reilly 和其他 200 多家出版商的大量文本和视频。有关更多信息，请访问[*http://oreilly.com*](http://oreilly.com)。

# 如何联系我们

请将有关本书的评论和问题发送至出版社：

+   O’Reilly Media, Inc.

+   1005 Gravenstein Highway North

+   Sebastopol, CA 95472

+   800-998-9938（美国或加拿大）

+   707-829-0515（国际或本地）

+   707-829-0104（传真）

我们为本书制作了一个网页，列出勘误、示例和任何额外信息。您可以访问[*https://oreil.ly/pak*](https://oreil.ly/pak)查看。

发送电子邮件至*bookquestions@oreilly.com*提出对本书的评论或技术问题。

关于我们的书籍和课程的新闻和信息，请访问[*http://oreilly.com*](http://oreilly.com)。

在 Facebook 上找到我们：[*http://facebook.com/oreilly*](http://facebook.com/oreilly)

在 Twitter 上关注我们：[*http://twitter.com/oreillymedia*](http://twitter.com/oreillymedia)

在 YouTube 上观看我们：[*http://youtube.com/oreillymedia*](http://youtube.com/oreillymedia)

# 致谢

本书得到了我们的技术审阅者 Adnan Sozuan 和 Andrew Gibel 的大力支持和改进。我们感谢 O’Reilly 的人们帮助我们聚集在一起，并给予我们完成这本书所需的所有支持，特别是 Jeff Bleiel 和 Zan McQuade。

我们感谢 Roman Elizarov 和 Jake Wharton 抽出时间与我们讨论 Kotlin 中并发演变的方向和 Android 低级光学的问题。

我们感谢我们的朋友、家人和同事的支持。我们感谢 Kotlin 社区以及那些抽出时间阅读早期草稿并提供反馈的个人。

最后，我们将这本书献给 Mike Dunn：合著者、同事、朋友和父亲。我们深切怀念他，希望这本书是他为之自豪的东西。
